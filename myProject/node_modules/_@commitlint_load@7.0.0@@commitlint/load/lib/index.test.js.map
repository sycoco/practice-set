{"version":3,"sources":["../src/index.test.js"],"names":["t","bootstrap","cwd","actual","deepEqual","rules","foo","is","file","parserPreset","name","parserOpts","headerPattern","throws","extends","one","two","zero","baz","outer","init","join","child","inner"],"mappings":"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","file":"index.test.js","sourcesContent":["import path from 'path';\nimport {fix, git} from '@commitlint/test';\nimport test from 'ava';\n\nimport load from '.';\n\ntest('extends-empty should have no rules', async t => {\n\tconst cwd = await git.bootstrap('fixtures/extends-empty');\n\tconst actual = await load({}, {cwd});\n\tt.deepEqual(actual.rules, {});\n});\n\ntest('uses seed as configured', async t => {\n\tconst cwd = await git.bootstrap('fixtures/extends-empty');\n\tconst actual = await load({rules: {foo: 'bar'}}, {cwd});\n\tt.is(actual.rules.foo, 'bar');\n});\n\ntest('rules should be loaded from specify config file', async t => {\n\tconst file = 'config/commitlint.config.js';\n\tconst cwd = await git.bootstrap('fixtures/specify-config-file');\n\tconst actual = await load({}, {cwd, file});\n\tt.is(actual.rules.foo, 'bar');\n});\n\ntest('uses seed with parserPreset', async t => {\n\tconst cwd = await git.bootstrap('fixtures/parser-preset');\n\tconst {parserPreset: actual} = await load(\n\t\t{\n\t\t\tparserPreset: './conventional-changelog-custom'\n\t\t},\n\t\t{cwd}\n\t);\n\tt.is(actual.name, './conventional-changelog-custom');\n\tt.deepEqual(actual.parserOpts, {\n\t\theaderPattern: /^(\\w*)(?:\\((.*)\\))?-(.*)$/\n\t});\n});\n\ntest('invalid extend should throw', async t => {\n\tconst cwd = await git.bootstrap('fixtures/extends-invalid');\n\tawait t.throws(load({}, {cwd}));\n});\n\ntest('empty file should have no rules', async t => {\n\tconst cwd = await git.bootstrap('fixtures/empty-object-file');\n\tconst actual = await load({}, {cwd});\n\tt.deepEqual(actual.rules, {});\n});\n\ntest('empty file should extend nothing', async t => {\n\tconst cwd = await git.bootstrap('fixtures/empty-file');\n\tconst actual = await load({}, {cwd});\n\tt.deepEqual(actual.extends, []);\n});\n\ntest('respects cwd option', async t => {\n\tconst cwd = await git.bootstrap('fixtures/recursive-extends/first-extended');\n\tconst actual = await load({}, {cwd});\n\tt.deepEqual(actual, {\n\t\textends: ['./second-extended'],\n\t\trules: {\n\t\t\tone: 1,\n\t\t\ttwo: 2\n\t\t}\n\t});\n});\n\ntest('recursive extends', async t => {\n\tconst cwd = await git.bootstrap('fixtures/recursive-extends');\n\tconst actual = await load({}, {cwd});\n\tt.deepEqual(actual, {\n\t\textends: ['./first-extended'],\n\t\trules: {\n\t\t\tzero: 0,\n\t\t\tone: 1,\n\t\t\ttwo: 2\n\t\t}\n\t});\n});\n\ntest('recursive extends with json file', async t => {\n\tconst cwd = await git.bootstrap('fixtures/recursive-extends-json');\n\tconst actual = await load({}, {cwd});\n\n\tt.deepEqual(actual, {\n\t\textends: ['./first-extended'],\n\t\trules: {\n\t\t\tzero: 0,\n\t\t\tone: 1,\n\t\t\ttwo: 2\n\t\t}\n\t});\n});\n\ntest('recursive extends with yaml file', async t => {\n\tconst cwd = await git.bootstrap('fixtures/recursive-extends-yaml');\n\tconst actual = await load({}, {cwd});\n\n\tt.deepEqual(actual, {\n\t\textends: ['./first-extended'],\n\t\trules: {\n\t\t\tzero: 0,\n\t\t\tone: 1,\n\t\t\ttwo: 2\n\t\t}\n\t});\n});\n\ntest('recursive extends with js file', async t => {\n\tconst cwd = await git.bootstrap('fixtures/recursive-extends-js');\n\tconst actual = await load({}, {cwd});\n\n\tt.deepEqual(actual, {\n\t\textends: ['./first-extended'],\n\t\trules: {\n\t\t\tzero: 0,\n\t\t\tone: 1,\n\t\t\ttwo: 2\n\t\t}\n\t});\n});\n\ntest('recursive extends with package.json file', async t => {\n\tconst cwd = await git.bootstrap('fixtures/recursive-extends-package');\n\tconst actual = await load({}, {cwd});\n\n\tt.deepEqual(actual, {\n\t\textends: ['./first-extended'],\n\t\trules: {\n\t\t\tzero: 0,\n\t\t\tone: 1,\n\t\t\ttwo: 2\n\t\t}\n\t});\n});\n\ntest('parser preset overwrites completely instead of merging', async t => {\n\tconst cwd = await git.bootstrap('fixtures/parser-preset-override');\n\tconst actual = await load({}, {cwd});\n\tt.is(actual.parserPreset.name, './custom');\n\tt.deepEqual(actual.parserPreset.parserOpts, {\n\t\theaderPattern: /.*/\n\t});\n});\n\ntest('recursive extends with parserPreset', async t => {\n\tconst cwd = await git.bootstrap('fixtures/recursive-parser-preset');\n\tconst actual = await load({}, {cwd});\n\tt.is(actual.parserPreset.name, './conventional-changelog-custom');\n\tt.is(typeof actual.parserPreset.parserOpts, 'object');\n\tt.deepEqual(\n\t\tactual.parserPreset.parserOpts.headerPattern,\n\t\t/^(\\w*)(?:\\((.*)\\))?-(.*)$/\n\t);\n});\n\ntest('ignores unknow keys', async t => {\n\tconst cwd = await git.bootstrap('fixtures/trash-file');\n\tconst actual = await load({}, {cwd});\n\n\tt.deepEqual(actual, {\n\t\textends: [],\n\t\trules: {\n\t\t\tfoo: 'bar',\n\t\t\tbaz: 'bar'\n\t\t}\n\t});\n});\n\ntest('ignores unknow keys recursively', async t => {\n\tconst cwd = await git.bootstrap('fixtures/trash-extend');\n\tconst actual = await load({}, {cwd});\n\n\tt.deepEqual(actual, {\n\t\textends: ['./one'],\n\t\trules: {\n\t\t\tzero: 0,\n\t\t\tone: 1\n\t\t}\n\t});\n});\n\ntest('find up from given cwd', async t => {\n\tconst outer = await fix.bootstrap('fixtures/outer-scope');\n\tawait git.init(path.join(outer, 'inner-scope'));\n\tconst cwd = path.join(outer, 'inner-scope', 'child-scope');\n\n\tconst actual = await load({}, {cwd});\n\n\tt.deepEqual(actual, {\n\t\textends: [],\n\t\trules: {\n\t\t\tchild: true,\n\t\t\tinner: false,\n\t\t\touter: false\n\t\t}\n\t});\n});\n\ntest('find up config from outside current git repo', async t => {\n\tconst outer = await fix.bootstrap('fixtures/outer-scope');\n\tconst cwd = await git.init(path.join(outer, 'inner-scope'));\n\tconst actual = await load({}, {cwd});\n\n\tt.deepEqual(actual, {\n\t\textends: [],\n\t\trules: {\n\t\t\tchild: false,\n\t\t\tinner: false,\n\t\t\touter: true\n\t\t}\n\t});\n});\n"]}