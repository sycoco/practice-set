'use strict';

Object.defineProperty(exports, "__esModule", {
	value: true
});
exports.getInjector = getInjector;

var _angular = require('angular');

var _angular2 = _interopRequireDefault(_angular);

var _dynamicExport = require('../dynamic-export');

var _dynamicExport2 = _interopRequireDefault(_dynamicExport);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

/**
 * 获取应用的injector,默认查询被ng-app标记的节点,否则从document.documentElement开始找
 * @param rootElement
 */
/**
 * @author Kuitos
 * @homepage https://github.com/kuitos/
 * @since 2016-04-25
 */

function getInjector() {
	var rootElement = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : document.querySelector('[ng-app]') || document.documentElement;


	var injector = _angular2.default.element(rootElement).injector();

	if (injector) {
		return injector;
	} else {

		var childNodes = rootElement.childNodes;

		for (var i = 0; i < childNodes.length; i++) {

			var _injector = getInjector(childNodes[i]);

			if (_injector) {
				return _injector;
			}
		}
	}

	return null;
}

// make commonjs have the same behavior with es6 module
var injector = null;
exports.default = injector;

(0, _dynamicExport2.default)(exports, 'default', function () {
	return injector || (injector = getInjector());
});